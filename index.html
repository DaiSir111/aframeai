<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A-Frame AR 演示</title>
  <!-- 使用更兼容的版本组合和CDN -->
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@ar-js-org/ar.js@3.3.2/aframe/build/aframe-ar.js"></script>
  
  <script>
    // 模型加载错误处理
    AFRAME.registerComponent('model-error-handler', {
      init: function() {
        this.el.addEventListener('model-loaded', function() {
          console.log('模型加载成功！');
        });
        this.el.addEventListener('model-error', function(e) {
          console.error('模型加载失败:', e.detail);
        });
      }
    });
  </script>
</head>
<body style="margin: 0; overflow: hidden;">
  <!-- 添加更完整的AR.js配置 -->
  <a-scene arjs='sourceType: webcam; debugUIEnabled: false;' embedded>
    <a-entity camera></a-entity>
    <!-- 添加标记图像用于AR识别 -->
    <a-marker preset="hiro">
      <a-entity 
        gltf-model="./demo/26380429b7334e1ea9723d2d858b921d.gltf" 
        position="0 0 0" 
        scale="0.01 0.01 0.01"
        model-error-handler
        animation="property: rotation; to: 0 360 0; loop:true; dur: 3000"
      ></a-entity>
    </a-marker>
    <!-- 当没有检测到标记时显示的消息 -->
    <a-entity id="noMarkerMessage" position="0 0 -1" scale="2 2 2" visible="false">
      <a-text value="请将摄像头对准HIRO标记" align="center"></a-text>
    </a-entity>
  </a-scene>
  
  <script>
    // 监听标记检测状态
    document.querySelector('a-marker').addEventListener('markerFound', function() {
      document.querySelector('#noMarkerMessage').setAttribute('visible', 'false');
    });
    
    document.querySelector('a-marker').addEventListener('markerLost', function() {
      document.querySelector('#noMarkerMessage').setAttribute('visible', 'true');
    });
    
    // 页面加载完成后检查AR功能
    window.addEventListener('load', function() {
      console.log('A-Frame AR页面加载完成');
    });
  </script>
</body>
</html>